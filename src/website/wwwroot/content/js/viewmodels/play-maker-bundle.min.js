var playMaker={init:function(){playMaker.play()},initPlayAfterTouchdown:function(){playMaker.playAfterTouchdown()},display:function(e){$("#playResult").text(e),$("#playCount").text(MODULES.GameVariables.TotalPlayCount)},getPlayResult:function(e){let o=0,t=UTILITIES.splitAndTitleCase(e),a=!1,l=!1,s=UTILITIES.getRandomInt(1,100)>=85,n=15,f=!1;self.playCountForPossession(self.playCountForPossession()+1),s&&(n=self.yardsToTouchdown()),MODULES.GameVariables.DiceSumTotal>=7&&(a=!0),MODULES.GameVariables.DiceSumTotal<=3&&(l=!0),e===GAME_PLAY_TYPES.TWOPOINTCONVERSION&&(f=!0,self.isKickoff(!0),self.SetupKickoff(),e===GAME_PLAY_TYPES.TWOPOINTCONVERSION&&MODULES.GameVariables.DiceSumTotal>=6?(o=UTILITIES.getRandomInt(1,4),o>=MODULES.Constants.TWO_POINT_CONVERSION_SPOT?(t+=" SUCCESSFUL",playMaker.addScore(SCORE_TYPES.TWOPOINTCONVERSION)):t+=" FAILED"):e===GAME_PLAY_TYPES.TWOPOINTCONVERSION&&(t+=" FAILED")),a&&e===GAME_PLAY_TYPES.PASS&&(o=UTILITIES.getRandomInt(1,n),t+=" Complete"),a&&e===GAME_PLAY_TYPES.RUN&&(o=UTILITIES.getRandomInt(1,n),t+=" Successful"),l&&e===GAME_PLAY_TYPES.PASS&&(o=-1*UTILITIES.getRandomInt(1,15),t="Sacked for a loss"),l&&e===GAME_PLAY_TYPES.RUN&&(o=-1*UTILITIES.getRandomInt(1,15),t+=" - tackled for a loss"),a||l||e!==GAME_PLAY_TYPES.PASS||(t+=" Incomplete"),a||l||e!==GAME_PLAY_TYPES.RUN||(t+=" for no gain"),o>=self.yardsToTouchdown()&&(e===GAME_PLAY_TYPES.PASS||e===GAME_PLAY_TYPES.RUN)&&(t=SCORE_TYPES.TOUCHDOWN.toUpperCase(),playMaker.addScore(SCORE_TYPES.TOUCHDOWN),self.pointAttemptAfterTouchDown(!0)),self.yardsToTouchdown()>100&&(e===GAME_PLAY_TYPES.PASS||e===GAME_PLAY_TYPES.RUN)&&(t=SCORE_TYPES.SAFETY.toUpperCase(),playMaker.addScore(SCORE_TYPES.SAFETY),self.isSafety(!0),self.SetupKickoff(),f=!0),o>=self.yardsToFirst()&&(e===GAME_PLAY_TYPES.PASS||e===GAME_PLAY_TYPES.RUN)?(self.yardsToFirst(10),self.currentDown(1)):4===self.currentDown()?f=!0:(self.yardsToFirst(self.yardsToFirst()-o),self.currentDown(self.currentDown()+1)),console.log("YARDS: "+o);let i=new MODULES.Constructors.PlayResult(o,t,f,e);return"fieldGoal"!==e&&"extraPoint"!==e&&"twoPointConversion"!==e&&self.yardsTraveled(self.yardsTraveled()+o),self.SetBallPosition(),f&&(playMaker.recordPlay(i),o=0,self.ballSpotStart(self.yardsToTouchdown()),self.yardsTraveled(0),t+=" Change of Possession",self.ChangePossession()),self.ShowHideSpecialTeamsMenu(),i},kickoff:function(e,o){let t=getKickoffType(),a=convertKickoffPowerToYards(t,e,o),l=0,s=UTILITIES.splitAndTitleCase(t),n=MODULES.Constants.KICKOFF_SPOT,f=!1,i=!1,r=t===KICKOFF_TYPES.KICKOFF||t===KICKOFF_TYPES.ONSIDE||t===KICKOFF_TYPES.PUNT||t===KICKOFF_TYPES.SAFETY,T=UTILITIES.getRandomInt(1,100);console.log("kickoffPower: %s, kickoffAngle: %s",e,o),(self.isPunt()||self.isFieldGoal())&&(n=self.currentBallSpot()),self.isSafety()&&(n=MODULES.Constants.SAFETY_KICKOFF_SPOT),self.isExtraPointKick()&&(n=MODULES.Constants.EXTRA_POINT_KICK_SPOT);let I=100-n,S=I+11;console.log("BEGINNING Kickoff Yards: %s, totalMaxKickWithoutTouchback: %s, BALL KICK OFF SPOT: %s",a,I,n);let c=self.awayTeamID(),E=self.homeTeamID();if(self.isBeginningOfHalf&&self.teamReceivingInitialKickoff()===self.homeTeamID()&&(c=self.homeTeamID(),E=self.awayTeamID()),self.isBeginningOfHalf=!1,self.isBeginningOfHalf||self.currentTeamWithBall()===self.homeTeamID()&&(c=self.homeTeamID(),E=self.awayTeamID()),t===KICKOFF_TYPES.ONSIDE){let t=!1;t=e>=25&&(kickOffAngle<=20||o>=80),t?(a=UTILITIES.getRandomInt(10,20),UTILITIES.getRandomInt(1,100)<=20?c=E:l=UTILITIES.getRandomInt(1,100)<=5?UTILITIES.getRandomInt(1,10):0):e<25?(a=35,s+=" Unsuccessful - Ball did not travel proper distance.",i=!0):o>20||o<80?(l=UTILITIES.getRandomInt(1,a+n),s+=" Unsuccessful - Receiving team made a return."):(a=35,s+=" Unsuccessful - Ball went out of bounds.",i=!0)}else if(t===KICKOFF_TYPES.EXTRAPOINT||t===KICKOFF_TYPES.FIELDGOAL)T>6?a>n+MODULES.Constants.END_ZONE_YARDS?(s+=" GOOD",playMaker.addScore(t)):s+=" NO GOOD":s+=" Blocked";else if(console.log("HANDLE NORMAL KICKOFF/PUNT/SAFETY"),T<6&&t===KICKOFF_TYPES.PUNT)s+=" Blocked";else if(!(o<=20||o>=80)||t!==KICKOFF_TYPES.SAFETY&&t!==KICKOFF_TYPES.KICKOFF)if(a>=S)f=!0;else if(console.log("Kickoff Yards: %s, totalMaxKickWithoutTouchback: %s",a,I),a>=I)if(UTILITIES.getRandomInt(1,100)>=85){let e=a-I,o=40,t=UTILITIES.getRandomInt(1,100);console.log("Chance of big return: %s, Minimum Return Yards: %s, Maximum Return Yards: %s",t,e,o),t>=90?(o=a+n,l=UTILITIES.getRandomInt(e,o)):l=UTILITIES.getRandomInt(e,o)}else f=!0;else console.log("Chance of normal return, Minimum Return Yards: %s, Maximum Return Yards: %s",1,a+n),l=UTILITIES.getRandomInt(1,a+n);else a=35,s+=" Penalty - Ball kicked out of bounds.",i=!0;console.log("Kickoff type: %s, Kickoff distance: %s, kickoff return: %s, TeamID With Ball: %s",t,a,l,c);let d=new MODULES.Constructors.PlayResult(a,s);if(self.currentTeamWithBall(E),playMaker.recordPlay(d),r){let e="Kickoff Return";if(f||i)f&&(e+=" - TOUCHBACK",a=MODULES.Constants.TOUCHBACK_YARD_LINE),self.ballSpotStart(a);else{let e=100-n+a-l;console.log("BALL SPOT TOTAL: %s",e),self.ballSpotStart(100-e)}let o=new MODULES.Constructors.PlayResult(l,e);self.currentTeamWithBall(c),playMaker.recordPlay(o)}self.SetBallPosition(),playMaker.resetKickoffFlags(t),r||(self.yardsToFirst(10),self.currentDown(1),self.isKickoff(!0),self.SetupKickoff())},resetKickoffFlags:function(e){self.showKickoffControls(!1),e===KICKOFF_TYPES.KICKOFF||e===KICKOFF_TYPES.ONSIDE?self.isKickoff(!1):e===KICKOFF_TYPES.EXTRAPOINT?self.isExtraPointKick(!1):e===KICKOFF_TYPES.SAFETY?self.isSafety(!1):e===KICKOFF_TYPES.FIELDGOAL?self.isFieldGoal(!1):e===KICKOFF_TYPES.PUNT&&self.isPunt(!1)},recordTimeOfPossession:function(e,o){let t=0;t+=5,e===GAME_PLAY_TYPES.RUN&&(t+=Math.round(o/2)),e===GAME_PLAY_TYPES.PASS&&(t+=2,t+=Math.round(o/10),t+=Math.round(o/4/2)),console.log("TIME OF POSSESSION: %s",self.timeOfPossession()),t=Math.round(t),self.timeOfPossession(t)},recordPlay:function(e){let o=$.grep(MODULES.GameVariables.Teams,(function(e){return e.teamId===self.currentTeamWithBall()}))[0],t="s";1!==e.yards&&-1!==e.yards||(t="");let a=e.yards.toString()+" Yard"+t;console.log("This Play:"+e.playResultText+" by the "+o.teamName()+" for "+a),self.AddPlayHistory(new MODULES.Constructors.PlayHistory(self.teamPlayHistory().length+1,self.currentTeamWithBall(),o.teamName(),HELPERS.getDownText(self.currentDown(),self.yardsToFirst()),self.playCountForPossession(),a,e.playResultText,HELPERS.getYardText())),playMaker.display(e.playResultText+" for "+e.yards.toString()+" Yard"+t),this.recordTimeOfPossession(e.playSelected,e.yards),this.recordGameStats(o,e)},recordGameStats:function(e,o){let t=new MODULES.Constructors.GamePlayStatRecord(e.teamId,e.teamName,1,0,0,self.timeOfPossession(),0,0);o.playType===GAME_PLAY_TYPES.RUN&&(t.totalYardsRushing=o.yards),o.playType===GAME_PLAY_TYPES.PASS&&(t.totalYardsPassing=o.yards),o.isTurnover&&(t.totalTurnovers=1),self.UpdateGameStat(t)},play:function(){let e=$("input[name=selectPlay]:checked").val();if(e){self.hasRolled(!1),$("#diceValues").empty();let o=playMaker.getPlayResult(e);playMaker.recordPlay(o),MODULES.GameVariables.TotalPlayCount+=1}else self.hasRolled(!0),alert("Choose a play")},playAfterTouchdown:function(){let e=$("input[name=afterTDPlay]:checked").val(),o=MODULES.Constants.EXTRA_POINT_KICK_SPOT;self.yardsTraveled(0),self.pointAttemptAfterTouchDown(!1),e===GAME_PLAY_TYPES.EXTRAPOINT?(self.isExtraPointKick(!0),self.SetupKickoff()):e===GAME_PLAY_TYPES.TWOPOINTCONVERSION&&(o=MODULES.Constants.TWO_POINT_CONVERSION_SPOT),self.ballSpotStart(o),self.SetBallPosition()},addScore:function(e){let o=0;switch(e){case SCORE_TYPES.TOUCHDOWN:o=6;break;case SCORE_TYPES.FIELDGOAL:o=3;break;case SCORE_TYPES.EXTRAPOINT:o=1;break;case SCORE_TYPES.SAFETY,SCORE_TYPES.TWOPOINTCONVERSION:o=2}currentTeamWithBall()===homeTeamID()?e===SCORE_TYPES.SAFETY?awayTeamScore(awayTeamScore()+o):homeTeamScore(homeTeamScore()+o):e===SCORE_TYPES.SAFETY?homeTeamScore(homeTeamScore()+o):awayTeamScore(awayTeamScore()+o),self.UpdateBoxScore()}};function getKickoffType(){let e=$("input[name=selectKickoffPlay]:checked").val();return self.isPunt()?e=KICKOFF_TYPES.PUNT:self.isFieldGoal()?e=KICKOFF_TYPES.FIELDGOAL:self.isSafety()?e=KICKOFF_TYPES.SAFETY:self.isExtraPointKick()&&(e=KICKOFF_TYPES.EXTRAPOINT),e}function convertKickoffPowerToYards(e,o,t){let a=0,l=0;if(e===KICKOFF_TYPES.EXTRAPOINT)l=o>=60?31:o>=40?29:o>=25?25:o;else if(e===KICKOFF_TYPES.ONSIDE)l=o>=90?UTILITIES.getRandomInt(66,75):o>=85?65:o>=70?UTILITIES.getRandomInt(50,64):o>=60?UTILITIES.getRandomInt(40,50):o>=50?UTILITIES.getRandomInt(30,40):o>=40?UTILITIES.getRandomInt(20,30):o>=30?UTILITIES.getRandomInt(10,20):UTILITIES.getRandomInt(1,10);else if(e===KICKOFF_TYPES.PUNT)l=o;else if(e===KICKOFF_TYPES.FIELDGOAL){let e=0;self.yardsToTouchdown()>=40?e=1:self.yardsToTouchdown()>=30?e=2:self.yardsToTouchdown()>=20?e=4:self.yardsToTouchdown()>=10?e=6:self.yardsToTouchdown()>=5?e=8:self.yardsToTouchdown()>=4?e=9:self.yardsToTouchdown()>=1&&(e=10),l=o>=90?UTILITIES.getRandomInt(60,70):o>=80?UTILITIES.getRandomInt(50,60):o>=70?UTILITIES.getRandomInt(40,50):o>=60?UTILITIES.getRandomInt(30,40):o>=50?UTILITIES.getRandomInt(20,30):o>=40?UTILITIES.getRandomInt(10,20):UTILITIES.getRandomInt(1,10),l+=e}else{let t=e===KICKOFF_TYPES.SAFETY?100-MODULES.Constants.SAFETY_KICKOFF_SPOT:100-MODULES.Constants.KICKOFF_SPOT;l=o>=98?t+11:o>=80?UTILITIES.getRandomInt(t+1,t+10):o>=75?t:o>=70?UTILITIES.getRandomInt(t-15,t-1):o>=60?UTILITIES.getRandomInt(t-25,t-15):o>=50?UTILITIES.getRandomInt(t-35,t-25):o>=40?UTILITIES.getRandomInt(t-45,t-35):o>=30?UTILITIES.getRandomInt(t-55,t-45):UTILITIES.getRandomInt(1,t-55)}return t<=0||t>=100?a=Math.round(l/2.8):t<=10||t>=90?a=Math.round(l/3.8):t<=20||t>=80?a=Math.round(l/4.8):t<=30||t>=70?a=Math.round(l/5.8):(t<=40||t>=60)&&(a=Math.round(l/6.8)),console.log("KICKOFF: Type: %s, Power: %s, Angle: %s, Angle subtractor: %s, Yards: ",e,o,t,a,l),l-a}!function(e){var o=this;o.teamPlayHistory=ko.observableArray(),o.AddPlayHistory=function(e){o.teamPlayHistory.push(e),o.teamPlayHistory.sort((function(e,o){return o.playId===e.playId?0:o.playId<e.playId?-1:1}))},o.MakePlay=function(){playMaker.init(),e("input[name=selectPlay][value=pass]").prop("checked","checked")},o.MakePlayAfterTD=function(){playMaker.initPlayAfterTouchdown(),e("input[name=afterTDPlay][value=extraPoint]").prop("checked","checked")}}(jQuery),function(e){var o=this;o.pointAttemptAfterTouchDown=ko.observable(!1),o.showKickoffControls=ko.observable(!0),o.isKickoff=ko.observable(!1),o.isSafety=ko.observable(!1),o.isPunt=ko.observable(!1),o.isFieldGoal=ko.observable(!1),o.isExtraPointKick=ko.observable(!1),o.teamReceivingInitialKickoff=ko.observable(0),o.teamReceivingInitialKickoffInfo=ko.computed((function(){return o.teamReceivingInitialKickoff()===o.homeTeamID()?o.homeTeamInfo():o.awayTeamInfo()})),o.kickoffPowerSliderIntervalId=0,o.kickoffAngleSliderIntervalId=0,o.kickoffPower=-1,o.kickoffAngle=-1,o.GetKickoffPower=function(){var t=parseInt(e("#kickoffPower").val(),10);e("#kickoffPower").prop("disabled",!0),clearInterval(o.kickoffPowerSliderIntervalId),e("#kickoffPowerSelected").text(t),o.kickoffPower=t},o.GetKickoffAngle=function(){var t=parseInt(e("#kickoffAngle").val(),10);e("#kickoffAngle").prop("disabled",!0),clearInterval(o.kickoffAngleSliderIntervalId),e("#kickoffAngleSelected").text(t),o.kickoffAngle=t},o.Kickoff=function(){console.log("kickoffPowerSelected: %s kickoffAngleSelected: %s",o.kickoffPower,o.kickoffAngle),o.kickoffPower>=0&&o.kickoffAngle>=0?playMaker.kickoff(kickoffPower,kickoffAngle):alert("Select kick power and angle")},o.SetupKickoff=function(){o.showKickoffControls(!0);let t=1,a=0;e("#kickoffPower").prop("disabled",!1),e("#kickoffAngle").prop("disabled",!1),o.kickoffPower=-1,o.kickoffAngle=-1,e("#kickoffAngleSelected").text("select angle"),e("#kickoffPowerSelected").text("select power"),o.SetupKickoffBallSpot(),o.kickoffPowerSliderIntervalId=window.setInterval((function(){e("#kickoffPower").val(a+=1*t),100===a&&(t=-1),0===a&&(t=1)}),MODULES.GameVariables.KickoffSliderDifficulty),o.kickoffAngleSliderIntervalId=window.setInterval((function(){e("#kickoffAngle").val(a+=1*t),100===a&&(t=-1),0===a&&(t=1)}),MODULES.GameVariables.KickoffSliderDifficulty)},o.PuntBall=function(){o.isPunt(!0),o.SetupKickoff()},o.KickFieldGoal=function(){o.isFieldGoal(!0),o.SetupKickoff()}}(jQuery);